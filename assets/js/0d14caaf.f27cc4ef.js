"use strict";(globalThis.webpackChunksintraprime_docs=globalThis.webpackChunksintraprime_docs||[]).push([[590],{5396(e,t,n){n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>x,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"core-concepts/workflow-runner","title":"Workflow Runner","description":"YAML/JSON declarative workflow automation with live auditable execution in SintraPrime.","source":"@site/docs/core-concepts/workflow-runner.md","sourceDirName":"core-concepts","slug":"/core-concepts/workflow-runner","permalink":"/SintraPrime/docs/core-concepts/workflow-runner","draft":false,"unlisted":false,"editUrl":"https://github.com/ihoward40/SintraPrime/tree/gh-pages-source/docs/core-concepts/workflow-runner.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Workflow Runner","description":"YAML/JSON declarative workflow automation with live auditable execution in SintraPrime."},"sidebar":"docsSidebar","previous":{"title":"Agent Mode Engine","permalink":"/SintraPrime/docs/core-concepts/agent-mode-engine"},"next":{"title":"Agent System Overview","permalink":"/SintraPrime/docs/agents/overview"}}');var l=n(4848),r=n(8453);const s={sidebar_position:5,title:"Workflow Runner",description:"YAML/JSON declarative workflow automation with live auditable execution in SintraPrime."},o="Workflow Runner",d={},c=[{value:"Workflow Definition",id:"workflow-definition",level:2},{value:"Trigger Types",id:"trigger-types",level:2},{value:"Step Configuration",id:"step-configuration",level:2},{value:"Conditional Execution",id:"conditional-execution",level:3},{value:"Retry Configuration",id:"retry-configuration",level:3},{value:"Variable Interpolation",id:"variable-interpolation",level:2},{value:"Execution",id:"execution",level:2},{value:"Receipt Integration",id:"receipt-integration",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.header,{children:(0,l.jsx)(t.h1,{id:"workflow-runner",children:"Workflow Runner"})}),"\n",(0,l.jsx)(t.p,{children:"The Workflow Runner enables declarative automation through YAML or JSON workflow definitions. Every workflow execution is fully auditable, with receipts generated for each step and the overall workflow."}),"\n",(0,l.jsx)(t.h2,{id:"workflow-definition",children:"Workflow Definition"}),"\n",(0,l.jsx)(t.p,{children:"Workflows are defined in YAML or JSON format:"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-yaml",metastring:'title="workflows/evidence-collection.yml"',children:'name: evidence-collection\nversion: "1.0"\ndescription: Collect and process evidence from multiple sources\n\ntrigger:\n  type: schedule\n  cron: "0 9 * * 1"  # Every Monday at 9 AM\n\ngovernance:\n  mode: SINGLE_RUN_APPROVED\n  max_cost: 5.00\n  approval_required: false\n\nsteps:\n  - id: capture-web\n    adapter: snapshot\n    action: capture\n    params:\n      urls:\n        - "https://example.com/policy"\n        - "https://example.com/terms"\n      format: pdf\n      diff_detection: true\n\n  - id: check-email\n    adapter: gmail\n    action: ingest\n    params:\n      label: "evidence"\n      since: "7d"\n\n  - id: build-timeline\n    adapter: timeline\n    action: build\n    depends_on: [capture-web, check-email]\n    params:\n      sources:\n        - "${{ steps.capture-web.output }}"\n        - "${{ steps.check-email.output }}"\n\n  - id: generate-report\n    adapter: narrative\n    action: generate\n    depends_on: [build-timeline]\n    params:\n      timeline: "${{ steps.build-timeline.output }}"\n      template: weekly-evidence-summary\n\non_error:\n  action: notify\n  adapter: slack\n  params:\n    channel: "#alerts"\n    message: "Evidence collection workflow failed: ${{ error.message }}"\n'})}),"\n",(0,l.jsx)(t.h2,{id:"trigger-types",children:"Trigger Types"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Trigger"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Example"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"manual"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Triggered by CLI or API"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/workflow run evidence-collection"})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"schedule"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Cron-based scheduling"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:'cron: "0 9 * * 1"'})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"webhook"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Triggered by incoming webhook"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"path: /hooks/evidence"})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"event"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Triggered by system events"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"event: receipt.created"})})]})]})]}),"\n",(0,l.jsx)(t.h2,{id:"step-configuration",children:"Step Configuration"}),"\n",(0,l.jsx)(t.p,{children:"Each step supports these fields:"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Field"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Required"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"id"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Unique step identifier"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"adapter"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Adapter to use for execution"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"action"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Action to perform"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"params"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Action parameters"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"depends_on"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Array of step IDs that must complete first"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"condition"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Conditional expression for execution"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"retry"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Retry configuration"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"timeout"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Step timeout in seconds"})]})]})]}),"\n",(0,l.jsx)(t.h3,{id:"conditional-execution",children:"Conditional Execution"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-yaml",children:'steps:\n  - id: notify-if-changes\n    adapter: slack\n    action: send\n    condition: "${{ steps.capture-web.output.changes_detected == true }}"\n    params:\n      channel: "#policy-changes"\n      message: "Policy changes detected!"\n'})}),"\n",(0,l.jsx)(t.h3,{id:"retry-configuration",children:"Retry Configuration"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-yaml",children:"steps:\n  - id: send-email\n    adapter: gmail\n    action: send\n    retry:\n      max_attempts: 3\n      backoff: exponential\n      initial_delay: 1000\n"})}),"\n",(0,l.jsx)(t.h2,{id:"variable-interpolation",children:"Variable Interpolation"}),"\n",(0,l.jsxs)(t.p,{children:["Workflows support variable interpolation using ",(0,l.jsx)(t.code,{children:"${{ }}"})," syntax:"]}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Expression"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"${{ steps.<id>.output }}"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Output from a previous step"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"${{ env.VARIABLE }}"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Environment variable"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"${{ trigger.payload }}"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Trigger payload data"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"${{ workflow.name }}"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Workflow metadata"})]})]})]}),"\n",(0,l.jsx)(t.h2,{id:"execution",children:"Execution"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:'# Run a workflow\nnpx sintraprime workflow run workflows/evidence-collection.yml\n\n# Run with parameter overrides\nnpx sintraprime workflow run workflows/evidence-collection.yml \\\n  --param urls="https://custom-url.com"\n\n# Dry run (plan without executing)\nnpx sintraprime workflow run workflows/evidence-collection.yml --dry-run\n\n# List all workflows\nnpx sintraprime workflow list\n\n# View workflow history\nnpx sintraprime workflow history evidence-collection\n'})}),"\n",(0,l.jsx)(t.h2,{id:"receipt-integration",children:"Receipt Integration"}),"\n",(0,l.jsx)(t.p,{children:"Every workflow execution generates receipts at two levels:"}),"\n",(0,l.jsxs)(t.ol,{children:["\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.strong,{children:"Step receipts"})," \u2014 One receipt per step, capturing inputs, outputs, and governance checks"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.strong,{children:"Workflow receipt"})," \u2014 A summary receipt for the entire workflow, referencing all step receipts"]}),"\n"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-json",metastring:'title="Workflow Receipt"',children:'{\n  "receipt_id": "rcpt_workflow_a1b2c3",\n  "operation": {\n    "type": "workflow.completed",\n    "workflow": "evidence-collection",\n    "steps_total": 4,\n    "steps_completed": 4,\n    "steps_failed": 0,\n    "duration_ms": 45000\n  },\n  "step_receipts": [\n    "rcpt_step_d4e5f6",\n    "rcpt_step_g7h8i9",\n    "rcpt_step_j0k1l2",\n    "rcpt_step_m3n4o5"\n  ]\n}\n'})}),"\n",(0,l.jsx)(t.admonition,{title:"Workflow Best Practices",type:"tip",children:(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"Keep workflows focused on a single concern"}),"\n",(0,l.jsxs)(t.li,{children:["Use ",(0,l.jsx)(t.code,{children:"depends_on"})," to express true dependencies, not sequencing"]}),"\n",(0,l.jsx)(t.li,{children:"Set appropriate timeouts for each step"}),"\n",(0,l.jsxs)(t.li,{children:["Always include ",(0,l.jsx)(t.code,{children:"on_error"})," handlers for production workflows"]}),"\n",(0,l.jsx)(t.li,{children:"Use dry runs to validate workflows before execution"}),"\n"]})}),"\n",(0,l.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.a,{href:"./agent-mode-engine",children:"Agent Mode Engine"})," \u2014 The underlying execution pipeline"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.a,{href:"../adapters/overview",children:"Adapters Overview"})," \u2014 Available adapters for workflow steps"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.a,{href:"../evidence-systems/lifecycle",children:"Evidence Lifecycle"})," \u2014 How workflows feed evidence systems"]}),"\n"]})]})}function x(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453(e,t,n){n.d(t,{R:()=>s,x:()=>o});var i=n(6540);const l={},r=i.createContext(l);function s(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);