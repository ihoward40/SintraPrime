"use strict";(globalThis.webpackChunksintraprime_docs=globalThis.webpackChunksintraprime_docs||[]).push([[5486],{9475(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"core-concepts/agent-mode-engine","title":"Agent Mode Engine","description":"The Validator \u2192 Planner \u2192 Executor pipeline that powers SintraPrime\'s governed task execution.","source":"@site/docs/core-concepts/agent-mode-engine.md","sourceDirName":"core-concepts","slug":"/core-concepts/agent-mode-engine","permalink":"/SintraPrime/docs/core-concepts/agent-mode-engine","draft":false,"unlisted":false,"editUrl":"https://github.com/ihoward40/SintraPrime/tree/gh-pages-source/docs/core-concepts/agent-mode-engine.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Agent Mode Engine","description":"The Validator \u2192 Planner \u2192 Executor pipeline that powers SintraPrime\'s governed task execution."},"sidebar":"docsSidebar","previous":{"title":"Immutable Receipt Ledger","permalink":"/SintraPrime/docs/core-concepts/receipt-ledger"},"next":{"title":"Workflow Runner","permalink":"/SintraPrime/docs/core-concepts/workflow-runner"}}');var r=t(4848),s=t(8453);const l={sidebar_position:4,title:"Agent Mode Engine",description:"The Validator \u2192 Planner \u2192 Executor pipeline that powers SintraPrime's governed task execution."},a="Agent Mode Engine",d={},c=[{value:"Pipeline Overview",id:"pipeline-overview",level:2},{value:"Stage 1: Validator",id:"stage-1-validator",level:2},{value:"Stage 2: Planner",id:"stage-2-planner",level:2},{value:"Stage 3: Executor",id:"stage-3-executor",level:2},{value:"CLI Commands",id:"cli-commands",level:2},{value:"Example Usage",id:"example-usage",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Integration with Governance",id:"integration-with-governance",level:2},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"agent-mode-engine",children:"Agent Mode Engine"})}),"\n",(0,r.jsxs)(n.p,{children:["The Agent Mode Engine is SintraPrime's core execution pipeline. Every task \u2014 whether submitted via CLI, webhook, or API \u2014 flows through the ",(0,r.jsx)(n.strong,{children:"Validator \u2192 Planner \u2192 Executor"})," pipeline, with governance enforcement and receipt generation at each stage."]}),"\n",(0,r.jsx)(n.h2,{id:"pipeline-overview",children:"Pipeline Overview"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph LR\n    A[Task Input] --\x3e B[Validator]\n    B --\x3e C[Planner]\n    C --\x3e D[Executor]\n    D --\x3e E[Receipt]\n    B -.->|Denied| F[Denial Receipt]\n    C -.->|Failed| F\n    D -.->|Failed| G[Failure Receipt]"}),"\n",(0,r.jsx)(n.h2,{id:"stage-1-validator",children:"Stage 1: Validator"}),"\n",(0,r.jsx)(n.p,{children:"The Validator is the first gate. It checks:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Schema validation"})," \u2014 Is the task well-formed?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Governance mode"})," \u2014 Is the current mode compatible with this task?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Policy gates"})," \u2014 Do all applicable policy gates pass?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Spending limits"})," \u2014 Will this task exceed budget constraints?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Agent permissions"})," \u2014 Is the assigned agent authorized for this operation?"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"interface ValidationResult {\n  valid: boolean;\n  errors: string[];\n  warnings: string[];\n  governance: {\n    mode: GovernanceMode;\n    gates_checked: string[];\n    gates_passed: string[];\n    approval_required: boolean;\n  };\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If validation fails, a ",(0,r.jsx)(n.strong,{children:"denial receipt"})," is generated and the task is rejected."]}),"\n",(0,r.jsx)(n.h2,{id:"stage-2-planner",children:"Stage 2: Planner"}),"\n",(0,r.jsx)(n.p,{children:"The Planner generates an execution plan:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Step decomposition"})," \u2014 Break the task into atomic steps"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Adapter selection"})," \u2014 Identify which adapters are needed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dependency ordering"})," \u2014 Determine step execution order"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cost estimation"})," \u2014 Estimate the total cost of execution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Risk assessment"})," \u2014 Flag high-risk operations"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="Example Plan"',children:'{\n  "plan_id": "plan_x7y8z9",\n  "task": "Send weekly report via email",\n  "steps": [\n    {\n      "id": "step_1",\n      "action": "generate_report",\n      "adapter": "shell",\n      "params": {"command": "npm run report:weekly"},\n      "estimated_cost": 0.00\n    },\n    {\n      "id": "step_2",\n      "action": "send_email",\n      "adapter": "gmail",\n      "depends_on": ["step_1"],\n      "params": {"to": "team@example.com", "subject": "Weekly Report"},\n      "estimated_cost": 0.001\n    }\n  ],\n  "total_estimated_cost": 0.001,\n  "risk_level": "low",\n  "approval_required": false\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"stage-3-executor",children:"Stage 3: Executor"}),"\n",(0,r.jsx)(n.p,{children:"The Executor runs the plan step by step:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sequential execution"})," \u2014 Steps run in dependency order"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Adapter invocation"})," \u2014 Each step calls its assigned adapter through the governance layer"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error handling"})," \u2014 Failures are caught, logged, and can trigger rollback"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Progress tracking"})," \u2014 Real-time status updates for each step"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Receipt generation"})," \u2014 A receipt is generated upon completion"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"cli-commands",children:"CLI Commands"}),"\n",(0,r.jsx)(n.p,{children:"The Agent Mode CLI provides direct access to the engine:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Command"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/run <task>"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Submit a task for full pipeline execution"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/plan <task>"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Generate a plan without executing it"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/status"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Show active tasks and system status"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/logs"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Display recent operation logs"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/config"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"View current engine configuration"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/validate-batch <file>"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Validate multiple tasks from a JSON file"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"/build-batch <file>"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Execute a batch of validated tasks"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"example-usage",children:"Example Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ npx sintraprime agent\n\n> /plan Analyze the latest web snapshots for policy changes\n[Planner] Generating execution plan...\n  Step 1: web-snapshot.list (adapter: snapshot)\n  Step 2: web-snapshot.diff (adapter: snapshot)\n  Step 3: analysis.generate (adapter: deepthink)\n  Estimated cost: $0.05\n  Risk level: low\n  Approval required: no\n\n> /run Analyze the latest web snapshots for policy changes\n[Validator] \u2713 Task validated\n[Planner]   \u2713 3-step plan generated\n[Executor]  \u2192 Step 1/3: Listing snapshots...\n[Executor]  \u2192 Step 2/3: Computing diffs...\n[Executor]  \u2192 Step 3/3: Generating analysis...\n[Executor]  \u2713 All steps completed\n[Receipt]   \u2713 rcpt_f8e7d6c5b4a3.json\n"})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.p,{children:"The engine implements a structured error handling strategy:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Error Type"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Behavior"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Validation failure"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Task rejected, denial receipt generated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Planning failure"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Task rejected, failure receipt generated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Step failure (retryable)"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Step retried up to 3 times"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Step failure (fatal)"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Remaining steps cancelled, failure receipt generated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Governance violation"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Immediate halt, violation receipt generated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Timeout"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Task cancelled, timeout receipt generated"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"integration-with-governance",children:"Integration with Governance"}),"\n",(0,r.jsx)(n.p,{children:"The Agent Mode Engine is deeply integrated with the governance layer:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pre-execution"})," \u2014 Validator checks all governance constraints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"During execution"})," \u2014 Each adapter call passes through governance"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Post-execution"})," \u2014 Receipt is generated and chained"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"On failure"})," \u2014 Failure receipts capture the full context"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Batch Operations",type:"tip",children:(0,r.jsxs)(n.p,{children:["For high-throughput scenarios, use batch operations (",(0,r.jsx)(n.code,{children:"/validate-batch"})," and ",(0,r.jsx)(n.code,{children:"/build-batch"}),") to process multiple tasks efficiently while maintaining full governance compliance."]})}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"./workflow-runner",children:"Workflow Runner"})," \u2014 Declarative workflow automation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../agents/overview",children:"Agent System Overview"})," \u2014 The multi-agent architecture"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"./receipt-ledger",children:"Receipt Ledger"})," \u2014 How receipts work"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453(e,n,t){t.d(n,{R:()=>l,x:()=>a});var i=t(6540);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);