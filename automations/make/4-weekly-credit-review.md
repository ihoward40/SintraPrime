# Make.com Scenario 4: Weekly Credit Review

## Overview

The Weekly Credit Review scenario generates a comprehensive summary of Make.com operation usage, helping operators understand and optimize automation costs.

## Purpose

- **Track**: Monitor Make.com operations consumed by all scenarios
- **Report**: Generate weekly usage summaries
- **Forecast**: Predict future credit needs
- **Optimize**: Identify scenarios for efficiency improvements

## Configuration

### Trigger

- **Type**: Scheduled
- **Schedule**: Every Monday at 9:00 AM (organization timezone)
- **Module**: Scheduled trigger

### Required Variables

From `fieldmap.manifest.v1.json`:

- `slack_webhook`: For report delivery (optional)
- `repo_path`: For saving report files

### Modules in Scenario

1. **Set Date Range**
   - Calculate: Previous 7 days
   - Start: `{{now}} - 7 days`
   - End: `{{now}}`

2. **Get Scenario Execution History**
   - Module: Make.com API module
   - Endpoint: `/organizations/{org_id}/scenarios/executions`
   - Filter: `executed_at >= {{start_date}}`

3. **Aggregate by Scenario**
   - Group by: Scenario ID/Name
   - Calculate:
     - Total operations consumed
     - Total executions
     - Success/failure rate
     - Average operations per execution

4. **Calculate Costs**
   - Operations consumed Ã— cost per operation
   - Total weekly cost
   - Project monthly cost

5. **Identify Top Consumers**
   - Sort scenarios by operations consumed
   - Extract top 5 (see OPERATOR_GUIDE.md)

6. **Format Report**
   - Generate markdown table
   - Add charts/graphs if available

7. **Save Report**
   - Path: `{{repo_path}}/automations/reports/weekly_{{date}}.md`
   - Format: Markdown

8. **Send to Slack** (optional)
   - Summary message with key metrics
   - Link to full report

## Report Template

### Weekly Make.com Credit Review

**Period**: {{start_date}} to {{end_date}}

#### Summary

- **Total Operations**: {{total_ops}}
- **Total Cost**: ${{total_cost}}
- **Projected Monthly Cost**: ${{monthly_cost}}
- **Success Rate**: {{success_rate}}%

#### Scenario Breakdown

| Scenario | Executions | Ops/Run | Total Ops | Cost | Success Rate |
|----------|------------|---------|-----------|------|--------------|
| 1. Runs Logger | {{exec_1}} | {{ops_per_1}} | {{total_1}} | ${{cost_1}} | {{success_1}}% |
| 2. Severity Classifier | {{exec_2}} | {{ops_per_2}} | {{total_2}} | ${{cost_2}} | {{success_2}}% |
| 3. Slack Alerts | {{exec_3}} | {{ops_per_3}} | {{total_3}} | ${{cost_3}} | {{success_3}}% |
| 4. Weekly Credit Review | {{exec_4}} | {{ops_per_4}} | {{total_4}} | ${{cost_4}} | {{success_4}}% |

#### Top 5 Scenarios by Operations

See OPERATOR_GUIDE.md for instructions on extracting this data.

1. {{top_1_name}}: {{top_1_ops}} operations
2. {{top_2_name}}: {{top_2_ops}} operations
3. {{top_3_name}}: {{top_3_ops}} operations
4. {{top_4_name}}: {{top_4_ops}} operations
5. {{top_5_name}}: {{top_5_ops}} operations

#### Efficiency Recommendations

{{recommendations}}

#### Anomalies Detected

{{anomalies}}

---

*Generated by SintraPrime Make.com Monitor*  
*Report saved at: automations/reports/weekly_{{date}}.md*

## Metrics to Track

### Per Scenario

- **Execution count**: How many times scenario ran
- **Operations consumed**: Total Make.com operations
- **Ops per execution**: Average efficiency
- **Success rate**: Percentage of successful runs
- **Error rate**: Failed executions
- **Avg duration**: Execution time

### Organization-Wide

- **Total operations**: Sum across all scenarios
- **Total cost**: Based on Make.com pricing tier
- **Utilization rate**: % of plan limit used
- **Trend**: Week-over-week change

## Recommendations Engine

### High Operations per Execution

If `ops_per_exec > expected_ops * 1.5`:

```
âš ï¸ Scenario "{{name}}" is consuming {{actual}} ops/run (expected: {{expected}})
ğŸ’¡ Recommendation: Review module configuration, consider optimizing data processing
```

### Low Success Rate

If `success_rate < 95%`:

```
âš ï¸ Scenario "{{name}}" has a {{success_rate}}% success rate
ğŸ’¡ Recommendation: Review error logs, add error handling, verify external dependencies
```

### Unused Scenarios

If `executions = 0`:

```
â„¹ï¸ Scenario "{{name}}" did not execute this week
ğŸ’¡ Recommendation: Verify schedule, check if scenario is needed
```

## Advanced Analytics

### Trend Analysis

Compare current week to previous 4 weeks:

- **Growing**: Operations increased by > 20%
- **Stable**: Operations within Â±20%
- **Declining**: Operations decreased by > 20%

### Forecasting

Use linear regression to predict:

- Operations needed for next week
- Estimated monthly cost
- Date when plan limit might be reached

## Output

### Saved Report

Path: `automations/reports/weekly_{{date}}.md`

### Data Store Entry

```json
{
  "report_id": "weekly_2026_01_20",
  "period_start": "2026-01-13",
  "period_end": "2026-01-20",
  "total_operations": 12500,
  "total_cost": 12.50,
  "success_rate": 98.2,
  "generated_at": "2026-01-20T09:00:00Z"
}
```

### Slack Summary

```
ğŸ“Š Weekly Make.com Credit Review

Period: Jan 13 - Jan 20, 2026

ğŸ”¢ Total Operations: 12,500 (â†‘ 5% from last week)
ğŸ’° Total Cost: $12.50
âœ… Success Rate: 98.2%

Top Consumer: Runs Logger (4,200 ops)

ğŸ“„ Full Report: automations/reports/weekly_2026_01_20.md
```

## Error Handling

- **API unavailable**: Retry up to 3 times, then generate report from cached data
- **Missing data**: Note gaps in report
- **Calculation errors**: Use fallback values, flag for review

## Maintenance

### Weekly

- Review generated report for accuracy
- Verify cost calculations match actual invoice
- Act on recommendations

### Monthly

- Compare forecasts to actual usage
- Adjust recommendations engine if needed
- Archive old reports

## Testing Checklist

- [ ] Report is generated every Monday at 9 AM
- [ ] All scenarios are included in breakdown
- [ ] Cost calculations are accurate
- [ ] Top 5 scenarios are correctly identified
- [ ] Recommendations are relevant
- [ ] Report is saved to correct location
- [ ] Slack summary is sent (if configured)

## Notes

- This scenario consumes operations itselfâ€”account for self-consumption
- Costs are estimates; verify against actual Make.com invoices
- Consider adding email delivery for non-Slack operators
- Store historical reports for trend analysis
- Use this data to justify Make.com plan upgrades/downgrades
